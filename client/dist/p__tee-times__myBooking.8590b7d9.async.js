(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"Sfx/":function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var r=n(a("wCAj"));a("14J3");var d=n(a("BMrR"));a("jCWc");var u=n(a("kPKH"));a("miYZ");var o=n(a("tsqr"));a("2qtc");var i=n(a("kLXV")),c=n(a("2Taf")),f=n(a("vZ4D")),m=n(a("MhPg")),s=n(a("l4Ni")),p=n(a("ujKo"));a("+L6B");var E=n(a("2/Rp")),g=l(a("q1tI")),y=a("MuoO"),h=n(a("W0ls")),M=n(a("Jdo2")),v=n(a("wd/R")),k=a("+n12"),B=n(a("7Tjx"));function b(e){var t=D();return function(){var a,l=(0,p.default)(e);if(t){var n=(0,p.default)(this).constructor;a=Reflect.construct(l,arguments,n)}else a=l.apply(this,arguments);return(0,s.default)(this,a)}}function D(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var C=window.config,O=E.default.Group,T=function(e){(0,m.default)(a,e);var t=b(a);function a(){var e;(0,c.default)(this,a);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n)),e.state={selectedRow:{},vModalDetail:!1,vModalModify:!1},e.showModalDetail=function(t){e.setState({selectedRow:t,vModalDetail:!0}),e.props.dispatch({type:"teetime/fetchBookingDetail",payload:{bkttno:t.BKTTNO}})},e.handleCancel=function(t){var a=e.props.dispatch;i.default.confirm({title:"Do you want to cancel your booking ?",content:e.checkCancelCondition(t)?"The cancellation of the flight or reduction of golfers made less than 24 hours on weekday and 72 hours on weekend/public holiday will be subject to prevailing levy of $30.00 and $60.00 (per golfer), respectively. The late cancellation fee will be charged to your account.":"",okText:"Yes",cancelText:"No",onOk:function(){a({type:"teetime/cancelBooking",payload:{bkid:t.BKTTNO,cardno:localStorage.getItem("card"),date:(0,v.default)(t.BDATE).format("YYYY-MM-DD")}}).then(function(){a({type:"teetime/fetchMyBookingList",payload:{cardno:localStorage.getItem("card")}})})},onCancel:function(){}})},e.handleModify=function(t){e.setState({selectedRow:t,vModalModify:!0}),e.props.dispatch({type:"teetime/fetchBookingDetail",payload:{bkttno:t.BKTTNO}}),e.props.dispatch({type:"user/fetchActiveMember"})},e.removeMember=function(t,a,l){var n=e.props.dispatch;parseInt(l.length)<=2?o.default.error("Minimum 2 golfers is required for booking."):3===parseInt(l.length)&&((0,k.filterDateinHolidayList)(t.BDATE)>0||(0,v.default)(t.BDATE).isoWeekday()>5)?o.default.error("Minimum 3 golfers is required for Public Holidays and Weekend Booking."):i.default.confirm({title:"Do you want to cancel booking for ".concat(l[a].MEMB_NAME," ?"),content:e.checkCancelCondition(t)?"The cancellation of the flight or reduction of golfers made less than 24 hours             on weekday and 72 hours on weekend/public holiday will be subject to prevailing levy             of S$30.00 and S$60.00 (per golfer), respectively. The late cancellation fee will be charged to your account.":"",okText:"Yes",cancelText:"No",onOk:function(){l.splice(a,1),n({type:"teetime/saveBookingDetail",payload:l}),i.default.destroyAll()},onCancel:function(){}})},e.saveMember=function(t,a,l){var n=e.props.dispatch;t.validateFieldsAndScroll(function(t,l){t||n({type:"user/checkMember",payload:{formData:{Date:a.BDATE,bshtno:a.BSHTNO,TimeFr:a.BTIME,holeno:a.HOLENO,Pax:parseInt(a.PAX)},values:l}}).then(function(t){t&&n({type:"teetime/updateBooking",payload:{bkttno:a.BKTTNO,cardno:localStorage.getItem("card"),MG:"M",bshtno:a.BSHTNO,date:(0,v.default)(a.BDATE,"YYYY-MM-DD").format("YYYYMMDD"),time:a.BTIME,NumberGuest:e.props.teetime.bookingDetail.length-1,no_hole:a.HOLENO,guests:l}}).then(function(){return e.setState({vModalModify:!1})}).then(function(){return e.props.dispatch({type:"teetime/fetchMyBookingList",payload:{cardno:localStorage.getItem("card")}})})})})},e}return(0,f.default)(a,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"teetime/fetchMyBookingList",payload:{cardno:localStorage.getItem("card")}})}},{key:"checkCancelCondition",value:function(e){var t=e.BTIME.split(":"),a=(0,v.default)(e.BDATE).hour(t[0]).minute(t[1]),l=a.isoWeekday()<6&&(0,k.filterDateinHolidayList)((0,v.default)(a).format("YYYY-MM-DD"))<0;return l?(0,v.default)().add(1,"day")>a:(0,v.default)().add(3,"day")>a}},{key:"parseString",value:function(e){switch(e){case"B":return"Book";case"S":return"Show up";case"X":return"Cancel";case"C":return"Confirmed"}}},{key:"render",value:function(){var e=this,t=this.state,a=t.selectedRow,l=t.vModalDetail,n=t.vModalModify,o=this.props.loadingBookingDetail,c=this.props.teetime,f=c.courseList,m=c.myBookingList,s=c.bookingDetail,p=c.loading,y=function(e,t){return e?e.filter(function(e){return e.COUR_CODE===t})[0].COUR_NAME:t},k=[{title:"Booking ID",dataIndex:"BKTTNO",key:"bkid",defaultSortOrder:"ascend",sorter:function(e,t){return e.BKTTNO-t.BKTTNO},render:function(t,a){return g.default.createElement(E.default,{type:"link",onClick:function(){return e.showModalDetail(a)}},t)}},{title:"Date",dataIndex:"BDATE",key:"date",render:function(e){return g.default.createElement("span",null,(0,v.default)(e).format(C.dateSetting.datePicker))}},{title:"Tee Time",dataIndex:"BTIME",key:"time"},{title:"Duration",dataIndex:"HOLENO",key:"duration",align:"center"},{title:"Players",dataIndex:"PAX",key:"Players",align:"center"},{title:"Course Name",className:"hidden-xs",dataIndex:"COUR_CODE",render:function(e){return g.default.createElement("span",null,y(f,e))}},{title:"Status",dataIndex:"BOOK_STAT",key:"status",render:function(t){return g.default.createElement("span",null,e.parseString(t))}},{title:"Action",key:"action",width:170,align:"right",render:function(t,a){return"Y"===a.BOOKMEMBER?g.default.createElement(O,null,a.PAX>=1?g.default.createElement(E.default,{type:"primary",onClick:function(){return e.handleModify(a)}},"Modify"):"",g.default.createElement(E.default,{type:"danger",onClick:function(){return e.handleCancel(a)}},"Cancel")):""}}],b=[{title:"Booking ID",dataIndex:"BKTTNO",key:"bkid",defaultSortOrder:"ascend",render:function(t,a){return g.default.createElement(E.default,{type:"link",onClick:function(){return e.showModalDetail(a)}},t)}},{title:"Date",dataIndex:"BDATE",key:"date",render:function(e){return g.default.createElement("span",null,(0,v.default)(e).format(C.dateSetting.datePicker))},align:"center"},{title:"Action",key:"action",align:"right",render:function(t,a){return"Y"===a.BOOKMEMBER?g.default.createElement(O,null,a.PAX>=1?g.default.createElement(E.default,{type:"primary",onClick:function(){return e.handleModify(a)}},"Modify"):"",g.default.createElement(E.default,{type:"danger",onClick:function(){return e.handleCancel(a)}},"Cancel")):""}}];return g.default.createElement("div",null,g.default.createElement(d.default,null,g.default.createElement(u.default,{span:24},g.default.createElement("div",{className:B.default.box},g.default.createElement(d.default,null,g.default.createElement(u.default,{sm:24,md:6},g.default.createElement("h3",null,"My Booking"))))),g.default.createElement(u.default,{span:24},g.default.createElement("div",{className:B.default.box},window.innerWidth>805?g.default.createElement(r.default,{loading:p,size:"small",columns:k,dataSource:m,pagination:{onChange:function(e){},pageSize:10}}):g.default.createElement(r.default,{loading:p,size:"small",columns:b,dataSource:m,pagination:{onChange:function(e){},pageSize:10}})))),g.default.createElement(i.default,{visible:l,title:"Booked",footer:null,onCancel:function(){return e.setState({vModalDetail:!1})}},o?g.default.createElement("div",{style:{marginBottom:"80px"}},g.default.createElement(M.default,null)):g.default.createElement("div",null,g.default.createElement(d.default,{type:"flex",align:"middle",style:{marginBottom:"0.5rem"}},g.default.createElement(u.default,{span:12,style:{paddingLeft:"50px"}},g.default.createElement("b",null,"Booking ID :"),g.default.createElement("br",null),a.BKTTNO,g.default.createElement("br",null)),g.default.createElement(u.default,{span:12,style:{paddingLeft:"50px"}},g.default.createElement("b",null,"Booker Name :"),g.default.createElement("br",null),s.length>0?s[0].MEMB_NAME:"")),g.default.createElement(d.default,{type:"flex",align:"middle",style:{marginBottom:"0.5rem"}},g.default.createElement(u.default,{span:24,style:{paddingLeft:"50px"}},g.default.createElement("b",null,"Course Name :"),g.default.createElement("br",null),a.COUR_CODE?y(f,a.COUR_CODE):"",g.default.createElement("br",null))),g.default.createElement(d.default,{type:"flex",align:"middle",style:{marginBottom:"0.5rem"}},g.default.createElement(u.default,{span:12,style:{paddingLeft:"50px"}},g.default.createElement("b",null,"Date :"),g.default.createElement("br",null),(0,v.default)(a.BDATE).format(C.dateSetting.datePicker)),g.default.createElement(u.default,{span:12,style:{paddingLeft:"50px"}},g.default.createElement("b",null,"Time :"),g.default.createElement("br",null),a.BTIME)),g.default.createElement(d.default,{type:"flex",align:"middle",style:{marginBottom:"0.5rem"}},g.default.createElement(u.default,{span:24,style:{paddingLeft:"50px"}},g.default.createElement("b",null,"Golfer :"),g.default.createElement("ol",{start:"2",style:{paddingLeft:"14px"}},s.slice(1).map(function(e,t){return g.default.createElement("li",{key:t},e.MEMB_NAME)})))))),g.default.createElement(h.default,{vModalModify:n,cancelFn:function(){return e.setState({vModalModify:!1})},loadingBookingDetail:o,selectedRow:a,bookingDetail:s,removeFn:this.removeMember,saveFn:this.saveMember}))}}]),a}(g.Component),x=(0,y.connect)(function(e){var t=e.user,a=e.teetime,l=e.loading;return{teetime:a,user:t,loadingBookingDetail:l.effects["teetime/fetchBookingDetail"]}})(T);t.default=x},W0ls:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var r=n(a("kLXV"));a("14J3");var d=n(a("BMrR"));a("jCWc");var u=n(a("kPKH"));a("IzEo");var o=n(a("bx4M"));a("y8nQ");var i=n(a("Vl3Y"));a("5NDa");var c=n(a("5rEg"));a("Pwec");var f=n(a("CtXQ")),m=n(a("eHn4")),s=n(a("qIgq"));a("OaEy");var p=n(a("2fM7")),E=l(a("q1tI")),g=a("MuoO"),y=n(a("7ZuR")),h=n(a("Jdo2")),M=n(a("wd/R")),v=n(a("7Tjx")),k=window.config,B=function(e){var t=e.form,a=e.loadingBookingDetail,l=e.cancelFn,n=e.removeFn,g=e.saveFn,B=e.bookingDetail,b=e.selectedRow,D=e.vModalModify,C=e.teetime,O=C.loading,T=C.courseList,x=e.user,w=x.memberList,N=x.loadingCheckMemberOk,I=t.getFieldDecorator,A={layout:"vertical"},S=p.default.Option,L=(0,E.useState)([]),R=(0,s.default)(L,2),_=R[0],Y=R[1],F=function(e){var a=e.dispatch,l=[],r=function(e,l){B[l].MG=e,a({type:"teetime/saveBookingDetail",payload:B}),"G"===e?(t.setFieldsValue((0,m.default)({},"fname-".concat(l+1),"Invite Guest")),t.setFieldsValue((0,m.default)({},"email-".concat(l+1),""))):t.setFieldsValue((0,m.default)({},"fname-".concat(l+1),""))},d=new y.default({encode:"icase",cache:!0,tokenize:"reverse",threshold:0,resolution:3,depth:3,doc:{id:"cardno",field:["cardno","card_giv"]}});d.add(w);var s=function(e){Y(d.search(e,9))},g=function(e,a){if(e){var l,n=w.find(function(t){return t.cardno===e});t.setFieldsValue((l={},(0,m.default)(l,"cardno-".concat(a),n.cardno),(0,m.default)(l,"fname-".concat(a),n.card_giv),l))}else{var r;t.setFieldsValue((r={},(0,m.default)(r,"cardno-".concat(a),""),(0,m.default)(r,"fname-".concat(a),""),r))}},h=function(e){B.push({CARDNO:null,MG:"G",MEMB_NAME:"Invited Guest",MEMB_EMAIL:""}),a({type:"teetime/saveBookingDetail",payload:B})},M=_.map(function(e,t){return E.default.createElement(S,{key:t,value:e.cardno},e.card_sal," ",e.card_giv)}),k=function(e,t){return E.default.createElement(E.default.Fragment,null,E.default.createElement("div",{style:{display:"flex",alignItems:"center"}},E.default.createElement(f.default,{type:"user"}),E.default.createElement("span",{style:{marginLeft:"20px"}}," ",t+1),E.default.createElement(p.default,{value:e.MG,style:{width:"200px",marginLeft:"20px"},onChange:function(e){return r(e,t)}},E.default.createElement(S,{value:"G"},"Guest"),E.default.createElement(S,{value:"M"},"Member"))),"M"===B[t].MG?E.default.createElement("div",{style:{display:"flex",alignItems:"center",margin:"10px 0"}},0===w.length?E.default.createElement(f.default,{type:"loading"}):E.default.createElement(f.default,{type:"search"}),E.default.createElement(p.default,{showSearch:0!==w.length,notFoundContent:null,defaultActiveFirstOption:!1,filterOption:!1,showArrow:!1,allowClear:!0,style:{width:"100%",marginLeft:"14px"},onChange:function(e){return g(e,t+1)},placeholder:"Search member",onSearch:s},M)):"")};if(B.length>1)for(var D=function(e){l.push(E.default.createElement(u.default,{xs:24,sm:8,key:e},E.default.createElement(o.default,{headStyle:{textAlign:"center"},title:k(B[e-1],e-1),bordered:!1,className:v.default.stepsContent2,actions:[E.default.createElement(f.default,{type:"delete",key:"delete",onClick:function(){return n(b,e-1,B)}})]},E.default.createElement(i.default,A,"G"===B[e-1].MG?E.default.createElement(E.default.Fragment,null,E.default.createElement(i.default.Item,{label:"First Name",className:v.default.formItemBottom},I("fname-".concat(e),{initialValue:B[e-1].MEMB_NAME})(E.default.createElement(c.default,{allowClear:!0}))),E.default.createElement(i.default.Item,{label:"E-mail",className:v.default.formItemBottom},I("email-".concat(e),{initialValue:B[e-1].MEMB_EMAIL})(E.default.createElement(c.default,{allowClear:!0,style:{width:"100%"}})))):E.default.createElement(E.default.Fragment,null,E.default.createElement(i.default.Item,{label:"Member's Name",className:v.default.formItemBottom},I("fname-".concat(e),{initialValue:B[e-1].MEMB_NAME,rules:[{message:"Please input your firstname!",whitespace:!0}]})(E.default.createElement(c.default,{readOnly:!0})))),E.default.createElement(i.default.Item,{className:v.default.formItemBottom,style:{padding:"0 !important"}},I("cardno-".concat(e),{initialValue:B[e-1].CARDNO})(E.default.createElement(c.default,{hidden:!0}))),E.default.createElement(i.default.Item,{className:v.default.formItemBottom,style:{padding:"0 !important"}},I("mg-".concat(e),{initialValue:B[e-1].MG})(E.default.createElement(c.default,{hidden:!0})))))))},C=2;C<B.length+1;C++)D(C);return B.length<4&&l.push(E.default.createElement(u.default,{xs:24,sm:8,key:4},E.default.createElement(o.default,{headStyle:{textAlign:"center"},title:null,bordered:!1,className:v.default.stepsContent3,onClick:function(){return h(l)}},E.default.createElement(f.default,{type:"plus",className:v.default.iconEmptyCard})))),l},P=function(e,t){return e?e.filter(function(e){return e.COUR_CODE===t})[0].COUR_NAME:t};return E.default.createElement(r.default,{width:900,visible:D,title:"Modify",onCancel:l,onOk:function(){return g(t,b,B)},confirmLoading:N||O,okText:"Save"},a?E.default.createElement("div",{style:{marginBottom:"80px"}},E.default.createElement(h.default,null)):E.default.createElement("div",null,E.default.createElement(d.default,{type:"flex",align:"middle",style:{marginBottom:"0.5rem"}},E.default.createElement(u.default,{span:12,style:{paddingLeft:"50px"}},E.default.createElement("b",null,"Booking ID :"),E.default.createElement("br",null),b.BKTTNO,E.default.createElement("br",null)),E.default.createElement(u.default,{span:12,style:{paddingLeft:"50px"}},E.default.createElement("b",null,"Booker Name :"),E.default.createElement("br",null),B.length>0?B[0].MEMB_NAME:"")),E.default.createElement(d.default,{type:"flex",align:"middle",style:{marginBottom:"0.5rem"}},E.default.createElement(u.default,{span:24,style:{paddingLeft:"50px"}},E.default.createElement("b",null,"Course Name :"),E.default.createElement("br",null),b.COUR_CODE?P(T,b.COUR_CODE):"",E.default.createElement("br",null))),E.default.createElement(d.default,{type:"flex",align:"middle",style:{marginBottom:"0.5rem"}},E.default.createElement(u.default,{span:12,style:{paddingLeft:"50px"}},E.default.createElement("b",null,"Date :"),E.default.createElement("br",null),(0,M.default)(b.BDATE).format(k.dateSetting.datePicker)),E.default.createElement(u.default,{span:12,style:{paddingLeft:"50px"}},E.default.createElement("b",null,"Time :"),E.default.createElement("br",null),b.BTIME)),E.default.createElement(d.default,{gutter:24,style:{padding:"1rem 3rem"}},E.default.createElement(u.default,{span:24},E.default.createElement("b",null,"Golfer :")),F(e))))},b=(0,g.connect)(function(e){var t=e.user,a=e.teetime,l=e.loading;return{teetime:a,user:t,loadingActiveMember:l.effects["user/fetchActiveMember"]}})(i.default.create()(B));t.default=b}}]);